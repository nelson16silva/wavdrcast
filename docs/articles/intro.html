<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with wavdrcast • wavdrcast</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting started with wavdrcast">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wavdrcast</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro.html">Getting started with wavdrcast</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting started with wavdrcast</h1>
            
      
      
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(wavdrcast)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This document introduces you to <code>wdrcast</code>’s functions. Based on the forecast performance criterion, these functions are applied in evaluation of wavelet-based core inflation and output gap measures. Package <code>wdrcast</code> uses “direct” forecast, not recursive one. In this method, forecasts are made using a horizon-specific estimated model, where the dependent variable is the multi-period ahead value being forecasted.</p>
<p>It is assumed that you are a little familiar with core inflation and output gap literature. Before describing the examples associated with core inflation and output gap, this vignette briefly presents the general direct forecasting model used in the package.</p>
</div>
<div id="model" class="section level1">
<h1 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h1>
<p>General OLS regression model is writing as:</p>
<p><span class="math display">\[\begin{equation}
    x_{t + h} = \alpha + \mathbf{{\beta}}'\mathbf{x}_t + \mathbf{{\gamma}}'\mathbf{z}_t + \mathbf{{\theta}}'\mathbf{d}_t + \epsilon_{t + h} 
\end{equation}\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(x_{t + h}\)</span>, regressed <span class="math inline">\(x\)</span> leaded <span class="math inline">\(h\)</span> step-ahead;</p></li>
<li><p><span class="math inline">\(\alpha\)</span>, constant;</p></li>
<li><p><span class="math inline">\(\mathbf{{\beta}}' = (\beta_0, \ldots, \beta_p)\)</span>, vector of <span class="math inline">\(p + 1\)</span> coefficients;</p></li>
<li><p><span class="math inline">\(\mathbf{x}_t = (x_t, \ldots, x_{t - p})'\)</span>, variable <span class="math inline">\(x\)</span> in <span class="math inline">\(t\)</span> and its <span class="math inline">\(p\)</span> lags;</p></li>
<li><p><span class="math inline">\(\mathbf{{\gamma}}' = (\gamma^1_0, \ldots, \gamma^1_{q_1}, \ldots, \gamma^n_0, \ldots, \gamma^n_{q_n}, \gamma^w_0, \ldots, \gamma^w_{q_w})\)</span>, vector of coefficients on <span class="math inline">\(\mathbf{z}_t\)</span>;</p></li>
<li><p><span class="math inline">\(\mathbf{z}_t = (z^1_t, \ldots, z^1_{t - q_1}, \ldots, z^n_t, \ldots, z^n_{t - q_n}, z^w_t, \ldots, z^w_{t - q_w})'\)</span>, vector of exogenous variables and its <span class="math inline">\(q_i\)</span>, <span class="math inline">\(i = (1, \ldots, n, w)\)</span>, lags. By convention, the exogenous variable from wavelet-based signal estimation (<span class="math inline">\(z^w_t\)</span>), if included, is ordered last. Lag variables are included sequentially and selected based on BIC or AIC information criterion. Then, if <span class="math inline">\(z^i_{t - q_i}\)</span> is included, so are <span class="math inline">\(z^i_{t - q_i + 1}, \ldots, z^i_{t}\)</span>. Also, some <span class="math inline">\(z^i\)</span> variables can be excluded from the final model, but at least one is presented in the general model specification;</p></li>
<li><p><span class="math inline">\(\mathbf{{\theta}}' = (\theta_1, \ldots, \theta_m)\)</span>, coefficients;</p></li>
<li><p><span class="math inline">\(\mathbf{d}_t = (d_1, \ldots, d_m)'\)</span>, exogenous variables not subjected to be lagged, possibly dummy variables;</p></li>
<li><p><span class="math inline">\(\epsilon_{t + h}\)</span>, white noise error term.</p></li>
</ul>
<p>If <span class="math inline">\(x_{t + h} = y_{t + h} - y_t\)</span>, then <span class="math inline">\(x_t = \Delta y_t = y_t - y_{t - 1}\)</span> and <span class="math inline">\(z^w_t = y_t - y^w_t\)</span>, where <span class="math inline">\(y^w_t\)</span> is a wavelet-based signal estimation of <span class="math inline">\(y_t\)</span>. For example, if <span class="math inline">\(y_t\)</span> is the logarithm of the output, then <span class="math inline">\(z^w_t = y_t - y^w_t\)</span> is the wavelet-base estimation of the output gap. Other variables <span class="math inline">\(z^{i'}_t, i' = (1, \ldots, n)\)</span> are never automatically differentiated, so it is a user’s decision to do that or not.</p>
<p>From this specification, it is possible to estimate particular models like:</p>
<ul>
<li>AR case:</li>
</ul>
<p><span class="math display">\[y_{t + h} - y_t = \alpha + \mathbf{{\beta}}\Delta \mathbf{y}_t + \epsilon_{t + h};\]</span></p>
<ul>
<li>evaluation of the wavelet-based output gap</li>
</ul>
<p><span class="math display">\[y_{t + h} - y_t = \alpha + \gamma_0^w z^w_t + \epsilon_{t + h};\]</span></p>
<ul>
<li>evaluation of core inflation measure that exclude food and energy</li>
</ul>
<p><span class="math display">\[x_{t + h}  = \alpha + \sum^p_{i = 0}\beta_ix_{t - i} + \sum^q_{i = 0}\gamma_i z_{t - i} + \epsilon_{t + h}.\]</span></p>
<p>In the last equation, it was assumed that the variable <span class="math inline">\(z\)</span> are not revised, as it is almost always the case of core inflation measure that exclude food and energy. If it is, there is a function in the package that allows one to consider cases where <span class="math inline">\(z\)</span> changes at each point in time. If <span class="math inline">\(z\)</span> is the core inflation measure from HP filter, for example, then an evaluation of the forecast property should consider that the estimation of <span class="math inline">\(z\)</span> changes for each out-of-sample observation. If <span class="math inline">\(z\)</span> includes <span class="math inline">\(z^w\)</span>, as is the case of the second equation above, then for each point in time a new estimation of <span class="math inline">\(z^w\)</span> is did automatically.</p>
</div>
<div id="core-inflation" class="section level1">
<h1 class="hasAnchor">
<a href="#core-inflation" class="anchor"></a>Core Inflation</h1>
<p>In this section the forecast property of core inflation measures is evaluated. First, the wavelet core inflation is evaluated followed by the analysis of the core that exclude food and energy. Finally, an AR model is estimated and then the three models are compared. Inflation and core inflation that exclude food and energy are monthly data from 1970-01 to 2019-10 and are included in the package dataset:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(inf)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; # A tibble: 598 x 2</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt;      cpi  core</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt;  1 0.265 0.253</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt;  2 0.529 0.505</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt;  3 0.526 0.754</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt;  4 0.785 0.499</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt;  5 0.260 0.496</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt;  6 0.518 0.741</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt;  7 0.515 0.245</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt;  8 0     0.244</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt;  9 0.513 0.732</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; 10 0.510 0.726</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; # ... with 588 more rows</span></a></code></pre></div>
<div id="model-1" class="section level2">
<h2 class="hasAnchor">
<a href="#model-1" class="anchor"></a>Model</h2>
<p>As an initial step, the code bellow generates dummies variables:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">dummies &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(</a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="dt">date =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="st">"1970-01-01"</span>),</a>
<a class="sourceLine" id="cb3-3" title="3">    lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span>(<span class="st">"2019-10-01"</span>),</a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="dt">by =</span> <span class="st">"months"</span></a>
<a class="sourceLine" id="cb3-5" title="5">  ),</a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="dt">month =</span> lubridate<span class="op">::</span><span class="kw"><a href="http://lubridate.tidyverse.org/reference/month.html">month</a></span>(date, <span class="dt">label =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-7" title="7">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">var =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span>(month, var, <span class="dt">fill =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span>date, <span class="op">-</span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">ends_with</a></span>(<span class="st">"dez"</span>))</a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12">dummies</a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt; # A tibble: 598 x 11</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt;      jan   fev   mar   abr   mai   jun   jul   ago   set   out   nov</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt;  1     1     0     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt;  2     0     1     0     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt;  3     0     0     1     0     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt;  4     0     0     0     1     0     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt;  5     0     0     0     0     1     0     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt;  6     0     0     0     0     0     1     0     0     0     0     0</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt;  7     0     0     0     0     0     0     1     0     0     0     0</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt;  8     0     0     0     0     0     0     0     1     0     0     0</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt;  9     0     0     0     0     0     0     0     0     1     0     0</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt; 10     0     0     0     0     0     0     0     0     0     1     0</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt; # ... with 588 more rows</span></a></code></pre></div>
<p>Then, the function <code><a href="../reference/model.html">model()</a></code> searches for the best OLS regression. For a wavelet specification, the model is:</p>
<p><span class="math display">\[\begin{equation}
    \pi_{t + h} = \alpha + \mathbf{{\beta}}'\mathbf{\pi}_t + (\mathbf{\gamma}^w)' \mathbf{\pi}^w_t + \mathbf{{\theta}}'\mathbf{d}_t + \epsilon_{t + h}, 
\end{equation}\]</span> where <span class="math inline">\(\pi\)</span> and <span class="math inline">\(\pi^w\)</span> are inflation and wavelet core inflation, respectively, and <span class="math inline">\(\mathbf{d}\)</span> contains the dummies.</p>
<p>The final model selected based on the minimum BIC (function default) is:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Wavelet core inflation (wav = TRUE argument)</span></a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3">inf_wav &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.html">model</a></span>(</a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="dt">df =</span> inf[<span class="dv">1</span>], <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">.h =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="dt">wav =</span> <span class="ot">TRUE</span>, <span class="dt">xreg =</span> dummies, <span class="dt">a =</span> <span class="ot">NA</span>, <span class="dt">vscale =</span> <span class="st">"level"</span></a>
<a class="sourceLine" id="cb4-6" title="6">)<span class="op">$</span>model</a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8">inf_wav</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; stats::lm(formula = cpi_lead2 ~ cpi_lag0 + cpi_lag1 + cpi_lag2 + </span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt;     cpi_wav_lag0 + cpi_wav_lag1 + cpi_wav_lag2 + jan + fev + </span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt;     mar + abr + mai + jun + jul + ago + set + out + nov)</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt;  (Intercept)      cpi_lag0      cpi_lag1      cpi_lag2  cpi_wav_lag0  </span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt;     0.157185     -0.077262     -0.150550     -0.195514      0.764794  </span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; cpi_wav_lag1  cpi_wav_lag2           jan           fev           mar  </span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt;     0.151177      0.362393     -0.008386     -0.052754     -0.024773  </span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt;          abr           mai           jun           jul           ago  </span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt;    -0.014496     -0.165886     -0.113934     -0.047382     -0.195014  </span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt;          set           out           nov  </span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt;    -0.361333     -0.364233      0.010032</span></a></code></pre></div>
<p>As indicated above, the regression involves cpi (<code>df = df[1]</code>), wavelet core inflation (<code>wav = TRUE</code>), and dummies (<code>xreg = dummies</code>) for two step-ahead (<code>.h = 2</code>). The maximum lags for cpi and core inflation is set to be 2 (<code>lags = c(2, 2)</code>). The wavelet core inflation is estimated from the empirical Bayes threshold method (<a href="https://cran.r-project.org/web/packages/EbayesThresh/index.html">EbayesThresh</a>), with <code>a = NA</code> determining the prior for Laplace function and <code>vscale = "level"</code> controlling the scale used at levels of the transform. If <code>wav = TRUE</code>, the number of columns of the <code>df</code> argument can be one, otherwise must be greather than one, as the two following examples show.</p>
<p>The same procedure is made for the base core inflation (that exclude food and energy) and a model that includes only AR terms of inflation, set by the <code>.var = "ar"</code> argument:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># Base core inflation (less food and energy)</span></a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3">inf_core &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.html">model</a></span>(<span class="dt">df =</span> inf, <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">.h =</span> <span class="dv">2</span>, <span class="dt">xreg =</span> dummies)<span class="op">$</span>model</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co"># AR</span></a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7">inf_ar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.html">model</a></span>(<span class="dt">df =</span> inf, <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">0</span>), <span class="dt">.h =</span> <span class="dv">2</span>, <span class="dt">.var =</span> <span class="st">"ar"</span>, <span class="dt">xreg =</span> dummies)</a></code></pre></div>
</div>
<div id="forecast-and-error" class="section level2">
<h2 class="hasAnchor">
<a href="#forecast-and-error" class="anchor"></a>Forecast and Error</h2>
<p>While the function <code><a href="../reference/model.html">model()</a></code> selects an OLS specification based on information criteria, the function <code><a href="../reference/fcast.html">fcast()</a></code> makes forecast from 1 to <span class="math inline">\(h\)</span> step-ahead. For each <span class="math inline">\(h\)</span> both the model and the wavelet core inflation are re-estimated. The arguments are the same as in <code><a href="../reference/model.html">model()</a></code> function:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">fcast_inf_wav &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fcast.html">fcast</a></span>(</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="dt">df =</span> inf[<span class="dv">1</span>], <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">.h =</span> <span class="dv">12</span>,</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="dt">wav =</span> <span class="ot">TRUE</span>, <span class="dt">xreg =</span> dummies, <span class="dt">a =</span> <span class="ot">NA</span>, <span class="dt">vscale =</span> <span class="st">"level"</span>)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; Registered S3 method overwritten by 'xts':</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt;   method     from</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt;   as.zoo.xts zoo</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt;   method            from</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt;   as.zoo.data.frame zoo</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; Registered S3 methods overwritten by 'forecast':</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt;   method             from    </span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt;   fitted.fracdiff    fracdiff</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt;   residuals.fracdiff fracdiff</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(fcast_inf_wav, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt;       1       2       3       4       5       6       7       8       9 </span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; -0.0262 -0.0478  0.3399  0.3758  0.3796  0.3030  0.2612  0.2543  0.1298 </span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt;      10      11      12 </span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt;  0.1877  0.2472  0.1270</span></a>
<a class="sourceLine" id="cb6-19" title="19"></a>
<a class="sourceLine" id="cb6-20" title="20">fcast_inf_core &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fcast.html">fcast</a></span>(<span class="dt">df =</span> inf, <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">.h =</span> <span class="dv">12</span>, <span class="dt">xreg =</span> dummies)</a>
<a class="sourceLine" id="cb6-21" title="21"></a>
<a class="sourceLine" id="cb6-22" title="22">fcast_inf_ar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fcast.html">fcast</a></span>(<span class="dt">df =</span> inf, <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">0</span>), <span class="dt">.h =</span> <span class="dv">12</span>, <span class="dt">.var =</span> <span class="st">"ar"</span>, <span class="dt">xreg =</span> dummies) </a></code></pre></div>
<p>A comparison of core inflation measures can be made from the root-mean-squared forecast error (RMSE) or mean absolute forecast error (MAE). The task of function <code><a href="../reference/error.html">error()</a></code> is to compute this:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">rmse_inf_wav &lt;-<span class="st"> </span><span class="kw"><a href="../reference/error.html">error</a></span>(</a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="dt">df =</span> inf[<span class="dv">1</span>], <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">.H =</span> <span class="dv">6</span>, <span class="dt">.K =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="dt">wav =</span> <span class="ot">TRUE</span>, <span class="dt">xreg =</span> dummies, <span class="dt">a =</span> <span class="ot">NA</span>, <span class="dt">vscale =</span> <span class="st">"level"</span></a>
<a class="sourceLine" id="cb7-4" title="4">)</a>
<a class="sourceLine" id="cb7-5" title="5">rmse_inf_wav</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; [1] 0.1948447 0.2301044 0.2222100 0.2043173 0.1860689 0.1659943</span></a>
<a class="sourceLine" id="cb7-7" title="7"></a>
<a class="sourceLine" id="cb7-8" title="8">rmse_inf_core &lt;-<span class="st"> </span><span class="kw"><a href="../reference/error.html">error</a></span>(<span class="dt">df =</span> inf, <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">.H =</span> <span class="dv">6</span>, <span class="dt">.K =</span> <span class="dv">25</span>, <span class="dt">xreg =</span> dummies)</a>
<a class="sourceLine" id="cb7-9" title="9"></a>
<a class="sourceLine" id="cb7-10" title="10">rmse_inf_ar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/error.html">error</a></span>(<span class="dt">df =</span> inf, <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">0</span>), <span class="dt">.H =</span> <span class="dv">6</span>, <span class="dt">.K =</span> <span class="dv">25</span>, <span class="dt">.var =</span> <span class="st">"ar"</span>, <span class="dt">xreg =</span> dummies)</a>
<a class="sourceLine" id="cb7-11" title="11"></a>
<a class="sourceLine" id="cb7-12" title="12">rmse_inf_wav <span class="op">/</span><span class="st">  </span>rmse_inf_ar</a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; [1] 1.0572230 1.1961511 1.2051808 1.0735181 0.9708062 0.8543558</span></a>
<a class="sourceLine" id="cb7-14" title="14">rmse_inf_core <span class="op">/</span><span class="st">  </span>rmse_inf_ar</a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; [1] 0.8928236 0.8571274 0.8874337 0.9915992 1.0008331 1.0109978</span></a>
<a class="sourceLine" id="cb7-16" title="16">rmse_inf_wav <span class="op">/</span><span class="st"> </span>rmse_inf_core</a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; [1] 1.1841342 1.3955347 1.3580516 1.0826129 0.9699980 0.8450619</span></a></code></pre></div>
<p>As results above show, core inflation that exclude food and energy can help to predict inflation better than an AR model or the wavelet core inflation. A better wavelet model, however, can be selected. Wavelet methods use a lot of parameters. Then, the function <code><a href="../reference/error_vin_wavmap.html">error_vin_wavmap()</a></code> can help one to select an appropriated specification based on forecasting criterion. This can be done in three steps.</p>
<p>First, combine the wavelet parameters:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">wavmap &lt;-<span class="st"> </span>wavsigmap<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/wavsigmap/man/map_wav_args.html">map_wav_args</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="dt">wf =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"haar"</span>, <span class="st">"la8"</span>),</a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="dt">vscale =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"independent"</span>, <span class="st">"level"</span>),</a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="dt">a =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb8-5" title="5">  <span class="dt">threshrule =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"median"</span>, <span class="st">"hard"</span>)</a>
<a class="sourceLine" id="cb8-6" title="6">))</a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8">wavmap</a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; # A tibble: 16 x 4</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt;    wf    vscale          a threshrule</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt;  1 haar  independent   0.5 median    </span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt;  2 haar  independent   0.5 hard      </span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt;  3 haar  independent   1   median    </span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt;  4 haar  independent   1   hard      </span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt;  5 haar  level         0.5 median    </span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt;  6 haar  level         0.5 hard      </span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt;  7 haar  level         1   median    </span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt;  8 haar  level         1   hard      </span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt;  9 la8   independent   0.5 median    </span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; 10 la8   independent   0.5 hard      </span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; 11 la8   independent   1   median    </span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; 12 la8   independent   1   hard      </span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co">#&gt; 13 la8   level         0.5 median    </span></a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">#&gt; 14 la8   level         0.5 hard      </span></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#&gt; 15 la8   level         1   median    </span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">#&gt; 16 la8   level         1   hard</span></a></code></pre></div>
<p>Second, use <code><a href="../reference/error_wavmap.html">error_wavmap()</a></code> to get the RMSE for every possible wavelet model and filter to find which one has the miminum RMSE:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">inf_wav_best &lt;-<span class="st"> </span><span class="kw"><a href="../reference/error_wavmap.html">error_wavmap</a></span>(wavmap,</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="dt">df =</span> inf[<span class="dv">1</span>], <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">.H =</span> <span class="dv">6</span>, <span class="dt">.K =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="dt">xreg =</span> dummies</a>
<a class="sourceLine" id="cb9-4" title="4">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/near.html">near</a></span>(</a>
<a class="sourceLine" id="cb9-6" title="6">    mean, <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-7" title="7">  ))</a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9">inf_wav_best</a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; # A tibble: 1 x 5</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt;   wf    vscale     a threshrule  mean</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="co">#&gt; 1 haar  level      1 hard       0.178</span></a></code></pre></div>
<p>Finally, rerun <code><a href="../reference/error.html">error()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">rmse_inf_wav_best &lt;-<span class="st"> </span><span class="kw"><a href="../reference/error.html">error</a></span>(</a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="dt">df =</span> inf[<span class="dv">1</span>], <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">.H =</span> <span class="dv">6</span>, <span class="dt">.K =</span> <span class="dv">25</span>,</a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="dt">wav =</span> <span class="ot">TRUE</span>, <span class="dt">xreg =</span> dummies, </a>
<a class="sourceLine" id="cb10-4" title="4">  <span class="dt">wf =</span> <span class="st">"haar"</span>, <span class="dt">vscale =</span> <span class="st">"level"</span>, </a>
<a class="sourceLine" id="cb10-5" title="5">  <span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">threshrule =</span> <span class="st">"hard"</span></a>
<a class="sourceLine" id="cb10-6" title="6">)</a>
<a class="sourceLine" id="cb10-7" title="7"></a>
<a class="sourceLine" id="cb10-8" title="8">rmse_inf_wav_best <span class="op">/</span><span class="st"> </span>rmse_inf_ar</a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt; [1] 0.9264700 0.9619519 0.9981551 0.9420647 0.9119893 0.8855672</span></a>
<a class="sourceLine" id="cb10-10" title="10">rmse_inf_wav_best <span class="op">/</span><span class="st"> </span>rmse_inf_core</a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt; [1] 1.0376854 1.1222974 1.1247658 0.9500458 0.9112301 0.8759338</span></a></code></pre></div>
<p>The wavelet core inflation selected on this way increases its forecast property. Further investigation of other parameters and/or wavelet shrinkage methods could improve the results.</p>
</div>
</div>
<div id="output-gap" class="section level1">
<h1 class="hasAnchor">
<a href="#output-gap" class="anchor"></a>Output Gap</h1>
<p>The evaluation of wavelet output gap in terms of the ability of its pseudo-real-time estimates to forecast future output growth is similar to the core inflation case. A particular forecast equation for an <span class="math inline">\(h\)</span>-period ahead is:</p>
<p><span class="math display">\[\begin{equation}
y_{t + h} - y_t = \alpha + \gamma^w_0\hat{c}^w_t + \epsilon_{t+h},
\end{equation}\]</span> where <span class="math inline">\(y\)</span> is the natural log of real GDP and <span class="math inline">\(\hat{c}^w\)</span> is the estimated wavelet output gap.</p>
<p>For <span class="math inline">\(h = 2\)</span>, the previous equation can be estimated as:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">gdp_wav_best &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.html">model</a></span>(</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="dt">df =</span> gdp[<span class="dv">1</span>], <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">.h =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="dt">wav =</span> <span class="ot">TRUE</span>, <span class="dt">.diff =</span> <span class="ot">TRUE</span>, <span class="dt">.var =</span> <span class="st">"ar_out"</span>,</a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="dt">wf =</span> <span class="st">"haar"</span>, <span class="dt">vscale =</span> <span class="st">"independent"</span>,</a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">threshrule =</span> <span class="st">"hard"</span></a>
<a class="sourceLine" id="cb11-6" title="6">)<span class="op">$</span>model</a></code></pre></div>
<p>Note the inclusion of arguments <code>.diff = TRUE</code> and <code>.var = "ar_out"</code> as well <code>lags = c(0, 0)</code> that defines zero lag for wavelet gap. Even if lags were set to <code>lags = c(6, 0)</code>, for example, the first element of it is automacally adjust to zero when <code>.var = "ar_out"</code> is set.</p>
<p>It is expected <span class="math inline">\(\gamma^w_0 &lt; 0\)</span> at some horizon <span class="math inline">\(h\)</span>. In this case, wavelet output gap helps to predict output growth:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(gdp_wav_best)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#&gt; lgdp_wav_diff_lag0 </span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">#&gt;       -2.93508e+11</span></a></code></pre></div>
<p>For the gap estimated from real potential GDP of the CBO’s estimate:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">gdp_gap &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model.html">model</a></span>(</a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="dt">df =</span> gdp, <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">.h =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="dt">.diff =</span> <span class="ot">TRUE</span>, <span class="dt">.var =</span> <span class="st">"ar_out"</span></a>
<a class="sourceLine" id="cb13-4" title="4">)<span class="op">$</span>model</a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="kw"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span>(gdp_gap)[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co">#&gt;    gap_lag0 </span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="co">#&gt; -0.07042408</span></a></code></pre></div>
<p>The analysis for forecast and mean error is similar to the core inflation case.</p>
<div id="phillips-curve" class="section level2">
<h2 class="hasAnchor">
<a href="#phillips-curve" class="anchor"></a>Phillips curve</h2>
<p>The package <code>wavdrcast</code> allows evaluation from a Phillips curve type of inflation forecasting. Pseudo-real time <span class="math inline">\(h\)</span>-period ahead equation is:</p>
<p><span class="math display">\[\begin{equation}
\pi_{t + h} - \pi_t = \alpha + \sum_{i = 0}^{p}\beta_i\Delta\pi_{t-i} + \sum_{i = 0}^{q^w}\gamma^w_i\hat{c}^w_{t-i} + \epsilon_{t + h}
\end{equation}\]</span></p>
<p>The point here is that <span class="math inline">\(y\)</span> generates <span class="math inline">\(\hat{c}^w\)</span>, not the dependent variable <span class="math inline">\(\pi\)</span>. Then, <span class="math inline">\(\hat{c}^w\)</span> needs to be generated by another function for every out-of-sample observation. This is the job of <code><a href="../reference/wavint.html">wavint()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">lgdp &lt;-<span class="st"> </span>gdp[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3">vin_wavgap &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wavint.html">wavint</a></span>(<span class="dt">x =</span> lgdp, <span class="dt">k =</span> <span class="dv">24</span>,</a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="dt">wf =</span> <span class="st">"haar"</span>,</a>
<a class="sourceLine" id="cb14-5" title="5">  <span class="dt">vscale =</span> <span class="st">"level"</span>, <span class="dt">a =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="dt">threshrule =</span> <span class="st">"hard"</span></a>
<a class="sourceLine" id="cb14-7" title="7">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span>(<span class="op">~</span><span class="st"> `</span><span class="dt">-</span><span class="st">`</span>(lgdp, .))</a>
<a class="sourceLine" id="cb14-9" title="9"></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(vin_wavgap[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">23</span><span class="op">:</span><span class="dv">25</span>)])</a>
<a class="sourceLine" id="cb14-11" title="11"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="co">#&gt;   lgdp24    lgdp2     lgdp1       lgdp0</span></a>
<a class="sourceLine" id="cb14-13" title="13"><span class="co">#&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="co">#&gt; 1     NA -0.0283  -0.0271   -0.0262    </span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="co">#&gt; 2     NA -0.0196  -0.0185   -0.0175    </span></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="co">#&gt; 3     NA -0.0124  -0.0112   -0.0103    </span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co">#&gt; 4     NA -0.00972 -0.00853  -0.00762   </span></a>
<a class="sourceLine" id="cb14-18" title="18"><span class="co">#&gt; 5     NA NA       -0.000907  0.00000356</span></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="co">#&gt; 6     NA NA       NA         0.00505</span></a></code></pre></div>
<p>This function constructed 25 estimatives of wavelet potencial gdp and the last part of the code above transformed them in outupt gap. The first column (lgdp24) of the tibble is the first out-of-sample data and (lgdp0) is the wavelet estimation using all data (the last out-of sample data).</p>
<p>For function compatibility, inflation data must have the same number of rows and columns of vin_wavgap object. To do that, the columns of quarterly cpi (infqtr) is repetead:</p>
<pre><code>#&gt; # A tibble: 282 x 25
#&gt;    infqtr24 infqtr23 infqtr22 infqtr21 infqtr20 infqtr19 infqtr18 infqtr17
#&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
#&gt;  1   -1.24    -1.24    -1.24    -1.24    -1.24    -1.24    -1.24    -1.24 
#&gt;  2    0.420    0.420    0.420    0.420    0.420    0.420    0.420    0.420
#&gt;  3    0        0        0        0        0        0        0        0    
#&gt;  4   -1.26    -1.26    -1.26    -1.26    -1.26    -1.26    -1.26    -1.26 
#&gt;  5    0        0        0        0        0        0        0        0    
#&gt;  6    0.847    0.847    0.847    0.847    0.847    0.847    0.847    0.847
#&gt;  7    2.52     2.52     2.52     2.52     2.52     2.52     2.52     2.52 
#&gt;  8    2.46     2.46     2.46     2.46     2.46     2.46     2.46     2.46 
#&gt;  9    3.2      3.2      3.2      3.2      3.2      3.2      3.2      3.2  
#&gt; 10    0.388    0.388    0.388    0.388    0.388    0.388    0.388    0.388
#&gt; # ... with 272 more rows, and 17 more variables: infqtr16 &lt;dbl&gt;,
#&gt; #   infqtr15 &lt;dbl&gt;, infqtr14 &lt;dbl&gt;, infqtr13 &lt;dbl&gt;, infqtr12 &lt;dbl&gt;,
#&gt; #   infqtr11 &lt;dbl&gt;, infqtr10 &lt;dbl&gt;, infqtr9 &lt;dbl&gt;, infqtr8 &lt;dbl&gt;,
#&gt; #   infqtr7 &lt;dbl&gt;, infqtr6 &lt;dbl&gt;, infqtr5 &lt;dbl&gt;, infqtr4 &lt;dbl&gt;,
#&gt; #   infqtr3 &lt;dbl&gt;, infqtr2 &lt;dbl&gt;, infqtr1 &lt;dbl&gt;, infqtr &lt;dbl&gt;</code></pre>
<p>When data are in a vintage form, function <code><a href="../reference/error_vin.html">error_vin()</a></code> calculates RMSE and MAE. Then for <code>.K = 25</code> out-of-sample observations:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">rmse_gap_wav_vin &lt;-<span class="st"> </span><span class="kw"><a href="../reference/error_vin.html">error_vin</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(vin_cpi, vin_wavgap), <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb16-2" title="2">          <span class="dt">.H =</span> <span class="dv">6</span>, <span class="dt">.K =</span> <span class="dv">25</span>, <span class="dt">.diff =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb16-3" title="3">          )</a>
<a class="sourceLine" id="cb16-4" title="4"></a>
<a class="sourceLine" id="cb16-5" title="5">rmse_gap_wav_vin</a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co">#&gt; [1] 0.5737995 0.6008153 0.5196295 0.5228903 0.6576797 0.6841850</span></a></code></pre></div>
<p>Note that the wav argument is the default (<code>wav = FALSE</code>) because the wavelet variable is not generated by <span class="math inline">\(\pi.\)</span> Then, the same procedure could be used for every output gap estimation as those by HP filter or unobserved component model, for example. For HP filter, this can be done setting a function that mimics <code><a href="../reference/wavint.html">wavint()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">hpvint &lt;-<span class="st"> </span><span class="cf">function</span>(x, k, ...) {</a>
<a class="sourceLine" id="cb17-2" title="2">  symx &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/nse-defuse.html">ensym</a></span>(x)</a>
<a class="sourceLine" id="cb17-3" title="3">  names &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(symx, <span class="st">"_hp"</span>, <span class="dv">0</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb17-4" title="4">  n &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(x)</a>
<a class="sourceLine" id="cb17-5" title="5">  m &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">nrow =</span> n, <span class="dt">ncol =</span> k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb17-7" title="7">    m[<span class="dv">1</span><span class="op">:</span>(n <span class="op">-</span><span class="st"> </span>i), i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span>(mFilter<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/mFilter/man/hpfilter.html">hpfilter</a></span>(x[<span class="dv">1</span><span class="op">:</span>(n <span class="op">-</span><span class="st"> </span>i)], ...)<span class="op">$</span>trend)</a>
<a class="sourceLine" id="cb17-8" title="8">  }</a>
<a class="sourceLine" id="cb17-9" title="9">  <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(m) &lt;-<span class="st"> </span>names</a>
<a class="sourceLine" id="cb17-10" title="10">  m &lt;-<span class="st"> </span>m[,(k<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb17-11" title="11">  tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(m)</a>
<a class="sourceLine" id="cb17-12" title="12">}</a></code></pre></div>
<p>This function can be used to generate HP vintages:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">vin_hpgap &lt;-<span class="st"> </span><span class="kw">hpvint</span>(lgdp, <span class="dv">24</span>,</a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="dt">freq =</span> <span class="dv">1600</span>, <span class="dt">type =</span> <span class="st">"lambda"</span></a>
<a class="sourceLine" id="cb18-3" title="3">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_all</a></span>(<span class="op">~</span><span class="st"> `</span><span class="dt">-</span><span class="st">`</span>(lgdp, .))</a>
<a class="sourceLine" id="cb18-5" title="5"></a>
<a class="sourceLine" id="cb18-6" title="6">vin_hpgap</a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt; # A tibble: 282 x 25</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt;    lgdp_hp24 lgdp_hp23 lgdp_hp22 lgdp_hp21 lgdp_hp20 lgdp_hp19 lgdp_hp18</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">#&gt;  1  -0.00158  -0.00158  -0.00158  -0.00158  -0.00158  -0.00158  -0.00158</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">#&gt;  2  -0.0201   -0.0201   -0.0201   -0.0201   -0.0201   -0.0201   -0.0201 </span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co">#&gt;  3  -0.0250   -0.0250   -0.0250   -0.0250   -0.0250   -0.0250   -0.0250 </span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co">#&gt;  4  -0.0485   -0.0485   -0.0485   -0.0485   -0.0485   -0.0485   -0.0485 </span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co">#&gt;  5  -0.0250   -0.0250   -0.0250   -0.0250   -0.0250   -0.0250   -0.0250 </span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="co">#&gt;  6  -0.00996  -0.00996  -0.00996  -0.00996  -0.00996  -0.00996  -0.00996</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co">#&gt;  7   0.0132    0.0132    0.0132    0.0132    0.0132    0.0132    0.0132 </span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">#&gt;  8   0.0176    0.0176    0.0176    0.0176    0.0176    0.0176    0.0176 </span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">#&gt;  9   0.0169    0.0169    0.0169    0.0169    0.0169    0.0169    0.0169 </span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">#&gt; 10   0.0203    0.0203    0.0203    0.0203    0.0203    0.0203    0.0203 </span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">#&gt; # ... with 272 more rows, and 18 more variables: lgdp_hp17 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="co">#&gt; #   lgdp_hp16 &lt;dbl&gt;, lgdp_hp15 &lt;dbl&gt;, lgdp_hp14 &lt;dbl&gt;, lgdp_hp13 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="co">#&gt; #   lgdp_hp12 &lt;dbl&gt;, lgdp_hp11 &lt;dbl&gt;, lgdp_hp10 &lt;dbl&gt;, lgdp_hp9 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="co">#&gt; #   lgdp_hp8 &lt;dbl&gt;, lgdp_hp7 &lt;dbl&gt;, lgdp_hp6 &lt;dbl&gt;, lgdp_hp5 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-24" title="24"><span class="co">#&gt; #   lgdp_hp4 &lt;dbl&gt;, lgdp_hp3 &lt;dbl&gt;, lgdp_hp2 &lt;dbl&gt;, lgdp_hp1 &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="co">#&gt; #   lgdp_hp0 &lt;dbl&gt;</span></a></code></pre></div>
<p>Then, mean error and comparison between the HP and wavelet gap can be made:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">rmse_gap_hp_vin &lt;-<span class="st"> </span><span class="kw"><a href="../reference/error_vin.html">error_vin</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(vin_cpi, vin_hpgap), <span class="dt">lags =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">2</span>), </a>
<a class="sourceLine" id="cb19-2" title="2">          <span class="dt">.H =</span> <span class="dv">6</span>, <span class="dt">.K =</span> <span class="dv">25</span>, <span class="dt">.diff =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb19-3" title="3">)</a>
<a class="sourceLine" id="cb19-4" title="4"></a>
<a class="sourceLine" id="cb19-5" title="5">rmse_gap_wav_vin <span class="op">/</span><span class="st"> </span>rmse_gap_hp_vin</a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co">#&gt; [1] 0.9696954 1.0187829 0.9887748 0.9892565 0.9711456 1.0051756</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#model">Model</a></li>
      <li>
<a href="#core-inflation">Core Inflation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#model-1">Model</a></li>
      <li><a href="#forecast-and-error">Forecast and Error</a></li>
      </ul>
</li>
      <li>
<a href="#output-gap">Output Gap</a><ul class="nav nav-pills nav-stacked">
<li><a href="#phillips-curve">Phillips curve</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nelson Silva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
